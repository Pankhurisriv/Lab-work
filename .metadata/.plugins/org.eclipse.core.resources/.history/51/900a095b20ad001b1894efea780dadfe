package com.cg.ova.service.test;

import java.math.BigInteger;
import java.util.Arrays;
import java.util.List;
import java.util.Optional;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.junit.jupiter.MockitoExtension;
import org.springframework.boot.test.context.SpringBootTest;

import com.example.demo.dao.IVegetableDTORepository;
import com.example.demo.entity.VegetableDTO;
import com.example.demo.exception.VegetableIdNotFoundException;
import com.example.demo.model.VegetableDTOModel;
import com.example.demo.service.VegetableDTOServiceImpl;

import static org.junit.jupiter.api.Assertions.*;

@ExtendWith(MockitoExtension.class)
@SpringBootTest
	public class VegetableDTOServiceImplTest {

		@Mock
		private IVegetableDTORepository vegetableDAO;

		@InjectMocks /*
						 * injecting package repository marked as @Mock into package service
						 * implementation
						 */
						 
		private VegetableDTOServiceImpl vegetableImpl;

  
  BigInteger bi= new BigInteger("100");

		@Test
		@DisplayName("VegetableServiceImpl::add should add list of existing packages as VegetableModel List")
		void testAddVegetable() throws VegetableIdNotFoundException {
			VegetableDTO testdata = new VegetableDTO(10L,"ORANGE","FRUIT",bi,2,null,null);
			
			VegetableDTOModel expected = new VegetableDTOModel(10L,"ORANGE","FRUIT",bi,2,null,null);

			Mockito.when(vegetableDAO.save(testdata)).thenReturn(testdata);
			
			VegetableDTOModel actual = vegetableImpl.addVegetable(expected);
			assertEquals(expected, actual);
		}

		@Test
		@DisplayName("VegetableServiceImpl::update should updated list of existing packages as VegetableDTOModel List")
		void testUpdateVegetable() throws VegetableIdNotFoundException {
			VegetableDTO testdata = new VegetableDTO(10L,"ORANGE","NON-LEAFY","FRUIT",70.0,1);
			VegetableDTOModel expected = new VegetableDTOModel(10L,"ORANGE","NON-LEAFY","FRUIT",70.0,1);

			Mockito.when(vegetableDAO.findById( testdata.getVegId())).thenReturn(Optional.of(testdata));
			
			VegetableDTOModel actual = vegetableImpl.updateVegetable(expected);
			assertEquals(expected, actual);

		}

		@Test
		@DisplayName("VegetableServiceImpl::removevegetables should remove list of existing packages as VegetableDTOModel list")
		void testRemoveVegetable() throws VegetableIdNotFoundException {
			VegetableDTO testdata = new VegetableDTO(10L,"ORANGE","NON-LEAFY","FRUIT",70.0,1);
			VegetableDTOModel expected = new VegetableDTOModel(10L,"ORANGE","NON-LEAFY","FRUIT",70.0,1);


		    Mockito.when(vegetableDAO.findById(10L)).thenReturn(Optional.of(testdata));
			Mockito.doNothing().when(vegetableDAO).deleteById(10L);
			boolean result = vegetableImpl.removeVegetable(10L);
			assertTrue(result);
		}

		@Test
		@DisplayName("VegetableServiceImpl::viewvegetable should return list of existing packages as VegetableDTOmodel ")
		void testViewVegetable() throws VegetableIdNotFoundException  {
			VegetableDTO testdata = new VegetableDTO(10L,"ORANGE","NON-LEAFY","FRUIT",70.0,1,null,null);
			VegetableDTOModel expected = new VegetableDTOModel(10L,"ORANGE","NON-LEAFY","FRUIT",70.0,1);

			Mockito.when(vegetableDAO.existsById(10L)).thenReturn(true);
			Mockito.when(vegetableDAO.findById(10L)).thenReturn(Optional.of(testdata));
			
			VegetableDTOModel actual= vegetableImpl.viewVegetable(10L);
			assertEquals(expected, actual);

		}
		@Test
		@DisplayName("CustomerServiceImpl::viewcustomerlist should return list of existing customer by location")
		void testViewVegetableList() throws VegetableIdNotFoundException {

			List<VegetableDTO> testdata = Arrays.asList(new VegetableDTO[] {
					new VegetableDTO(10L,"ORANGE","NON-LEAFY","FRUIT",70.0,1),
					new VegetableDTO(11L,"APPLE","NON-LEAFY","FRUIT",80.0,2)
			});

			
			
			List<VegetableDTOModel> expected = Arrays.asList(new VegetableDTOModel[] {
					new VegetableDTOModel(10L,"ORANGE","NON-LEAFY","FRUIT",70.0,1),
					new VegetableDTOModel(11L,"APPLE","NON-LEAFY","FRUIT",80.0,2)
			});

			Mockito.when(vegetableDAO. existsByType("FRUIT")).thenReturn(true);
			
			Mockito.when(vegetableDAO.findByType("FRUIT")).thenReturn(Optional.of(testdata));
			
			List<VegetableDTOModel> actual = vegetableImpl.viewVegetableList("FRUIT");
			
			assertEquals(expected, actual);
		}

}*/
